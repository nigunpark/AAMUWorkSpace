<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="aamu.mybatis.mapper.main">
	<insert id="placeInsert" parameterType="attrDTO">
		INSERT INTO places VALUES(#{contentid},#{areacode},#{contenttypeid},#{sigungucode},#{title},#{addr},#{bigimage},#{smallimage},#{mapx},#{mapy},#{kakaokey},#{tel},#{url})
	</insert>
	<insert id="infoInsert" parameterType="attrDTO">
		INSERT INTO placesinfo VALUES(#{contentid},#{resttime},#{playtime},#{park})
	</insert>
	<insert id="hotelInsert" parameterType="attrDTO">
		INSERT INTO hotelinfo VALUES(#{contentid},#{checkin},#{checkout})
	</insert>
	<insert id="dinerInsert" parameterType="attrDTO">
		INSERT INTO dinerinfo VALUES(#{contentid},#{menu})
	</insert>
	<insert id="eventInsert" parameterType="attrDTO">
		INSERT INTO eventinfo VALUES(#{contentid},TO_DATE(#{eventstart},'YYYY-MM-DD'),TO_DATE(#{eventend},'YYYY-MM-DD'),#{charge},#{eventtime})
	</insert>
	
	<select id="selectPlacesList" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN placesinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND <![CDATA[rownum<=100]]>
	</select>
	<select id="selectEventList" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN eventinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND <![CDATA[rownum<=100]]>
	</select>
	<select id="selectHotelList" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN hotelinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND <![CDATA[rownum<=100]]>
	</select>
	<select id="selectDinerList" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN dinerinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND <![CDATA[rownum<=100]]>
	</select>
	
	<insert id="plannerInsert" parameterType="planDTO">
		INSERT INTO routeboard VALUES(SEQ_PLA.NEXTVAL,#{title},SYSDATE,#{id})
	</insert>
	
	<insert id="routeInsert" parameterType="routeDTO">
		INSERT INTO route VALUES(#{contentid},#{day},#{starttime},#{atime},#{mtime})
	</insert>
	
	<select id="selectRouteList" parameterType="int" resultType="routeDTO">
		SELECT * FROM route WHERE rbn=#{rbn}
	</select>
	
	<select id="selectAttrSigungu" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN placesinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND p.sigungucode=#{sigungucode} AND <![CDATA[rownum<=20]]>
	</select>
	<select id="selectEventSigungu" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN eventinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND p.sigungucode=#{sigungucode} AND <![CDATA[rownum<=20]]>
	</select>
	<select id="selectHotelSigungu" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN hotelinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND p.sigungucode=#{sigungucode} AND <![CDATA[rownum<=20]]>
	</select>
	<select id="selectDinerSigungu" parameterType="Map" resultType="attrDTO">
		SELECT p.*,i.* FROM places p JOIN dinerinfo i ON p.contentid=i.contentid WHERE p.areacode=#{areacode} AND p.contenttypeid=#{contenttypeid} AND p.sigungucode=#{sigungucode} AND <![CDATA[rownum<=20]]>
	</select>
	
	
	<select id="selectOnePlace" parameterType="int" resultType="attrDTO">
		SELECT * FROM places WHERE contentid=#{contentid}
	</select>
	
	<select id="searchTwoPlace" parameterType="Map" resultType="attrDTO">
		SELECT * FROM places WHERE ${searchcolumn} LIKE '%'||#{searchword}||'%' or #{searchcolumn2} LIKE '%'||#{searchword}||'%'
	</select>
	
	<select id="searchOnePlace" parameterType="Map" resultType="attrDTO">
		SELECT * FROM hotelinfo WHERE ${searchcolumn} LIKE '%'||#{searchword}||'%'
	</select>
	
	<update id="updateUrl" parameterType="attrDTO">
		UPDATE hotelinfo SET checkin=#{checkin} WHERE contentid=#{contentid}
	</update>
	
	<select id="checkPlace" parameterType="int" resultType="int">
		SELECT count(*) FROM places WHERE contentid=#{contentid}
	</select>
</mapper>